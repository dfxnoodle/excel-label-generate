<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CUHK Label Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/main.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <!-- Elegant Header -->
        <div class="text-center mb-4">
            <h1>üèõÔ∏è CUHK Label Generator</h1>
            <p class="lead">Professional Mailing Label Generation System</p>
        </div>
        
        <div class="d-flex justify-content-end mb-3">
            <a href="/config-page" class="btn btn-outline-primary">‚öôÔ∏è Configuration</a>
        </div>
        
        <!-- File Upload Section -->
        <div class="card mb-4">
            <div class="card-header">
                <h3>üì§ Step 1: Upload Excel File</h3>
            </div>
            <div class="card-body">
                <form id="uploadForm" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="excelFile" class="form-label">Select Excel File (.xlsx or .xls)</label>
                        <input type="file" class="form-control" id="excelFile" accept=".xlsx,.xls" required>
                    </div>
                    <button type="submit" class="btn btn-primary">üìÇ Upload File</button>
                </form>
                
                <div id="uploadResult" class="mt-3"></div>
            </div>
        </div>
        
        <!-- Configuration Section -->
        <div class="card mb-4" id="configSection" style="display: none;">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h3>‚öôÔ∏è Step 2: Configure Filters (Optional)</h3>
                <div>
                    <button type="button" class="btn btn-sm btn-outline-secondary me-2" data-bs-toggle="modal" data-bs-target="#statusHelpModal">
                        üìã Status Guide
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#categoryHelpModal">
                        ‚ùì Category Guide
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="alert alert-light border mb-4" style="border-left: 4px solid var(--royal-gold) !important;">
                    <strong>üí° Quick Tips:</strong> All filters are optional. Combine multiple filters for precise selection. 
                    Click the guide buttons above for detailed code references. 
                    Use Step 2.5 to export and verify your filtered data before generating labels.
                </div>
                
                <!-- Filter Mode Toggle -->
                <div class="alert alert-info border mb-4 d-flex justify-content-between align-items-center">
                    <div>
                        <strong>üîç Filter Logic Mode:</strong>
                        <span id="filterModeDescription" class="ms-2">
                            <span id="orModeDesc">Rows matching <strong>ANY</strong> selected status/category (e.g., C_acd OR C_mgt)</span>
                            <span id="andModeDesc" style="display: none;">Rows matching <strong>ALL</strong> selected status/category (e.g., C_acd AND C_mgt)</span>
                        </span>
                    </div>
                    <div class="btn-group" role="group" aria-label="Filter mode toggle">
                        <input type="radio" class="btn-check" name="filterMode" id="filterModeOr" value="OR" checked autocomplete="off">
                        <label class="btn btn-outline-primary" for="filterModeOr">OR</label>
                        
                        <input type="radio" class="btn-check" name="filterMode" id="filterModeAnd" value="AND" autocomplete="off">
                        <label class="btn btn-outline-primary" for="filterModeAnd">AND</label>
                    </div>
                </div>
                
                <form id="configForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="categoryFilter" class="form-label">
                                    Category Filter 
                                    <span class="badge bg-info ms-2" style="cursor: help;" title="Click 'Category Guide' button for full list">
                                        ?
                                    </span>
                                </label>
                                <div class="input-group mb-2">
                                    <select class="form-select" id="categoryDropdown" multiple size="5">
                                        <optgroup label="Academic & Research">
                                            <option value="C_acd">Academic Units</option>
                                            <option value="C_acd_dept">Academic Departments</option>
                                            <option value="C_acd_oths">Other Academic Units</option>
                                            <option value="C_acd_prof">Professors at Large</option>
                                            <option value="C_rsh">Research Units</option>
                                            <option value="C_rsh_ctr">Research Centers</option>
                                            <option value="C_rsh_inst">Research Institutes</option>
                                            <option value="C_rsh_key">State Key Laboratories</option>
                                            <option value="C_jrsh">Joint Research Units</option>
                                        </optgroup>
                                        <optgroup label="Administrative">
                                            <option value="C_mgt">Management Units</option>
                                            <option value="C_mgt_offr">University Officers</option>
                                            <option value="C_adm_sev">Admin & Services</option>
                                            <option value="C_org">Staff Organizations</option>
                                        </optgroup>
                                        <optgroup label="Student & College">
                                            <option value="C_su">Student Unions</option>
                                            <option value="C_col">Colleges</option>
                                            <option value="C_hst">Student Hostels</option>
                                        </optgroup>
                                        <optgroup label="Facilities">
                                            <option value="C_fac">Facilities</option>
                                            <option value="C_can">Canteens</option>
                                        </optgroup>
                                    </select>
                                    <button class="btn btn-outline-secondary" type="button" id="clearCategoryBtn">Clear</button>
                                </div>
                                <input type="text" class="form-control" id="categoryFilter" 
                                       placeholder="e.g., C_mgt,C_rsh_ctr,C_su">
                                <small class="form-text text-muted">
                                    <strong>Use dropdown above or type manually.</strong> Hold Ctrl/Cmd to select multiple.
                                </small>
                            </div>
                            
                            <div class="mb-3">
                                <label for="categoryExcludeFilter" class="form-label">Category Exclude Filter</label>
                                <div class="input-group mb-2">
                                    <select class="form-select" id="categoryExcludeDropdown" multiple size="3">
                                        <option value="C_acd">Academic Units</option>
                                        <option value="C_mgt">Management Units</option>
                                        <option value="C_rsh_ctr">Research Centers</option>
                                        <option value="C_su">Student Unions</option>
                                        <option value="C_col">Colleges</option>
                                        <option value="C_can">Canteens</option>
                                    </select>
                                    <button class="btn btn-outline-secondary" type="button" id="clearCategoryExcludeBtn">Clear</button>
                                </div>
                                <input type="text" class="form-control" id="categoryExcludeFilter" 
                                       placeholder="e.g., C_acd,C_mgt">
                                <small class="form-text text-muted">Select categories to exclude</small>
                            </div>
                            
                            <div class="mb-3">
                                <label for="statusFilter" class="form-label">
                                    Status Filter
                                    <span class="badge bg-info ms-2" style="cursor: help;" title="Click 'Status Guide' button for full list">
                                        ?
                                    </span>
                                </label>
                                <button type="button" class="btn btn-sm btn-link p-0 ms-2" data-bs-toggle="modal" data-bs-target="#statusHelpModal">
                                    View Status Codes
                                </button>
                                <div class="input-group mb-2">
                                    <select class="form-select" id="statusDropdown" multiple size="5">
                                        <optgroup label="Internal">
                                            <option value="1">1 - CU Admin/Academic Depts</option>
                                            <option value="2">2 - Units Other than CU</option>
                                            <option value="3">3 - CU Individual/Special</option>
                                        </optgroup>
                                        <optgroup label="VIP & Honorary">
                                            <option value="4">4 - Council Members</option>
                                            <option value="5">5 - Emeritus Professors</option>
                                            <option value="6">6 - Honorary Graduates</option>
                                            <option value="7">7 - College Trustees</option>
                                            <option value="8">8 - Advisory Boards</option>
                                            <option value="27">27 - Honorary Fellows</option>
                                        </optgroup>
                                        <optgroup label="Donors & Special">
                                            <option value="9">9 - College Donors</option>
                                            <option value="10">10 - Newsletter/Subscription</option>
                                            <option value="90">90 - Alumni</option>
                                        </optgroup>
                                        <optgroup label="Local External">
                                            <option value="11">11 - Government</option>
                                            <option value="12">12 - Local Culture</option>
                                            <option value="13">13 - Local Individuals</option>
                                            <option value="15">15 - Local Tertiary</option>
                                            <option value="19">19 - Secondary Schools</option>
                                        </optgroup>
                                        <optgroup label="Overseas">
                                            <option value="17">17 - Overseas Individuals</option>
                                            <option value="18">18 - Special Request</option>
                                            <option value="20">20 - Overseas Culture</option>
                                            <option value="21">21 - Overseas Tertiary</option>
                                        </optgroup>
                                        <optgroup label="Government Officials">
                                            <option value="22">22 - LegCo Members</option>
                                            <option value="23">23 - ExeCo Members</option>
                                            <option value="24">24 - Education Commission</option>
                                            <option value="26">26 - Consulates</option>
                                        </optgroup>
                                    </select>
                                    <button class="btn btn-outline-secondary" type="button" id="clearStatusBtn">Clear</button>
                                </div>
                                <input type="text" class="form-control" id="statusFilter" 
                                       placeholder="e.g., 1,2,3,4">
                                <small class="form-text text-muted">
                                    <strong>Use dropdown above or type manually.</strong> Hold Ctrl/Cmd to select multiple.
                                </small>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="statusExcludeFilter" class="form-label">Status Exclude Filter</label>
                                <div class="input-group mb-2">
                                    <select class="form-select" id="statusExcludeDropdown" multiple size="3">
                                        <option value="90">90 - Alumni</option>
                                        <option value="10">10 - Newsletter/Subscription</option>
                                        <option value="2">2 - Units Other than CU</option>
                                    </select>
                                    <button class="btn btn-outline-secondary" type="button" id="clearStatusExcludeBtn">Clear</button>
                                </div>
                                <input type="text" class="form-control" id="statusExcludeFilter" 
                                       placeholder="e.g., 4,5">
                                <small class="form-text text-muted">Select statuses to exclude</small>
                            </div>
                            
                            <div class="mb-3">
                                <label for="mailZoneFilter" class="form-label">
                                    Mail Zone Filter
                                    <span class="badge bg-info ms-2" style="cursor: help;" title="1=Internal, 2=HK Island, 3=Kowloon/NT, 4=China/Taiwan/Macau, 5=Others">
                                        ?
                                    </span>
                                </label>
                                <div class="input-group mb-2">
                                    <select class="form-select" id="mailZoneDropdown" multiple size="5">
                                        <option value="1">1 - Internal Circulation</option>
                                        <option value="2">2 - Hong Kong Island</option>
                                        <option value="3">3 - Kowloon, New Territories</option>
                                        <option value="4">4 - China, Taiwan, Macau</option>
                                        <option value="5">5 - International (All Others)</option>
                                    </select>
                                    <button class="btn btn-outline-secondary" type="button" id="clearMailZoneBtn">Clear</button>
                                </div>
                                <input type="text" class="form-control" id="mailZoneFilter" 
                                       placeholder="e.g., 1,2,3" readonly>
                                <small class="form-text text-muted">
                                    <strong>Use dropdown above.</strong> Hold Ctrl/Cmd to select multiple zones.
                                </small>
                            </div>
                            
                            <!-- Custom Text Settings - Individual Publications -->
                            <div class="mb-3">
                                <label class="form-label">
                                    <i class="bi bi-file-earmark-text"></i> Custom Text Settings
                                    <span class="badge bg-info" data-bs-toggle="modal" data-bs-target="#publicationInfoModal" 
                                          style="cursor: pointer;" title="Learn more about publications">
                                        ?
                                    </span>
                                </label>
                                <div class="border rounded p-3 bg-light">
                                    <p class="mb-2 text-muted small">
                                        <strong>B. For Individual Publications</strong><br>
                                        Select publication columns to filter recipients. Only rows with positive numbers (‚â•1) in these columns will be included.
                                    </p>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="pubBE" value="BE">
                                        <label class="form-check-label" for="pubBE">
                                            <strong>BE</strong> - Bulletin English
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="pubBC" value="BC">
                                        <label class="form-check-label" for="pubBC">
                                            <strong>BC</strong> - Bulletin Chinese
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="pubBEC" value="BEC">
                                        <label class="form-check-label" for="pubBEC">
                                            <strong>BEC</strong> - Bulletin English & Chinese
                                        </label>
                                    </div>
                                    <small class="text-muted d-block mt-2">
                                        <i class="bi bi-info-circle"></i> These correspond to the number of copies to be sent to each recipient.
                                    </small>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="limitNumber" class="form-label">Limit Number of Labels</label>
                                <input type="number" class="form-control" id="limitNumber" min="1" 
                                       placeholder="e.g., 100">
                                <small class="form-text text-muted">Maximum number of labels to generate</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="batchSize" class="form-label">Batch Size</label>
                                <input type="number" class="form-control" id="batchSize" min="1" 
                                       placeholder="e.g., 50">
                                <small class="form-text text-muted">Number of labels per batch</small>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="startIndex" class="form-label">Start Index</label>
                                <input type="number" class="form-control" id="startIndex" min="0" value="0">
                                <small class="form-text text-muted">Starting index for batch processing</small>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Data Preview Section -->
        <div class="card mb-4" id="previewSection" style="display: none;">
            <div class="card-header">
                <h3>Data Preview</h3>
            </div>
            <div class="card-body">
                <div id="dataPreview"></div>
            </div>
        </div>
        
        <!-- Export Filtered Data Section -->
        <div class="card mb-4" id="exportSection" style="display: none;">
            <div class="card-header">
                <h3>üìä Step 2.5: Export Filtered Data (Optional)</h3>
            </div>
            <div class="card-body">
                <p class="text-muted">
                    Before generating labels, you can export the filtered data to Excel to review what will be included.
                </p>
                <button type="button" class="btn btn-info btn-lg" id="exportBtn">
                    <span class="export-btn-text">üì• Export Filtered Excel</span>
                    <span class="export-btn-loading" style="display: none;">
                        <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                        Exporting...
                    </span>
                </button>
                <div id="exportResult" class="mt-3"></div>
            </div>
        </div>
        
        <!-- Generate Labels Section -->
        <div class="card mb-4" id="generateSection" style="display: none;">
            <div class="card-header">
                <h3>üéØ Step 3: Generate Labels</h3>
            </div>
            <div class="card-body">
                <button type="button" class="btn btn-success btn-lg me-3" id="generateBtn">
                    üìÑ Generate Labels PDF
                </button>
                <a href="/config-page" class="btn btn-outline-primary">
                    ‚öôÔ∏è Edit Configuration
                </a>
                <div id="generateResult" class="mt-3"></div>
            </div>
        </div>
        
        <!-- Loading Spinner -->
        <div id="loadingSpinner" class="text-center" style="display: none;">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">Processing...</p>
        </div>
    </div>

    <!-- Category Help Modal -->
    <div class="modal fade" id="categoryHelpModal" tabindex="-1" aria-labelledby="categoryHelpModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="categoryHelpModalLabel">Category Filter Reference Guide</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted">
                        Use these category codes in the "Category Filter" field. Enter multiple codes separated by commas 
                        (e.g., <code>C_mgt,C_rsh_ctr,C_su</code>) to include multiple categories.
                    </p>
                    
                    <h6 class="mt-4 mb-3">üìö Academic & Research Categories</h6>
                    <table class="table table-sm table-hover">
                        <thead>
                            <tr>
                                <th style="width: 30%;">Code</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>C_acd</code></td>
                                <td>Academic Units</td>
                            </tr>
                            <tr>
                                <td><code>C_acd_dept</code></td>
                                <td>Academic Units - Departments</td>
                            </tr>
                            <tr>
                                <td><code>C_acd_oths</code></td>
                                <td>Other Academic Units</td>
                            </tr>
                            <tr>
                                <td><code>C_acd_prof</code></td>
                                <td>Academic Units - Professors at Large</td>
                            </tr>
                            <tr>
                                <td><code>C_rsh</code></td>
                                <td>Research Units</td>
                            </tr>
                            <tr>
                                <td><code>C_rsh_ctr</code></td>
                                <td>Research Centers</td>
                            </tr>
                            <tr>
                                <td><code>C_rsh_inst</code></td>
                                <td>Research Institutes</td>
                            </tr>
                            <tr>
                                <td><code>C_rsh_key</code></td>
                                <td>State Key Laboratories</td>
                            </tr>
                            <tr>
                                <td><code>C_jrsh</code></td>
                                <td>Joint Research Units</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h6 class="mt-4 mb-3">üè¢ Administrative & Management Categories</h6>
                    <table class="table table-sm table-hover">
                        <thead>
                            <tr>
                                <th style="width: 30%;">Code</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>C_mgt</code></td>
                                <td>University Management Units</td>
                            </tr>
                            <tr>
                                <td><code>C_mgt_offr</code></td>
                                <td>University Officers</td>
                            </tr>
                            <tr>
                                <td><code>C_adm_sev</code></td>
                                <td>Professional Administrative and Services Units</td>
                            </tr>
                            <tr>
                                <td><code>C_org</code></td>
                                <td>Staff Organizations</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h6 class="mt-4 mb-3">üéì Student & College Categories</h6>
                    <table class="table table-sm table-hover">
                        <thead>
                            <tr>
                                <th style="width: 30%;">Code</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>C_su</code></td>
                                <td>Student Unions</td>
                            </tr>
                            <tr>
                                <td><code>C_col</code></td>
                                <td>Colleges</td>
                            </tr>
                            <tr>
                                <td><code>C_hst</code></td>
                                <td>Student Hostels</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h6 class="mt-4 mb-3">üèóÔ∏è Facilities & Services Categories</h6>
                    <table class="table table-sm table-hover">
                        <thead>
                            <tr>
                                <th style="width: 30%;">Code</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>C_fac</code></td>
                                <td>Facilities</td>
                            </tr>
                            <tr>
                                <td><code>C_can</code></td>
                                <td>Canteens</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="alert alert-info mt-4">
                        <strong>üí° Tips:</strong>
                        <ul class="mb-0 mt-2">
                            <li>Use comma-separated values for multiple categories: <code>C_mgt,C_acd,C_su</code></li>
                            <li>Use "Category Exclude Filter" to exclude specific categories</li>
                            <li>Export filtered Excel first to verify your filter selection</li>
                            <li>Category codes are case-sensitive</li>
                        </ul>
                    </div>
                    
                    <div class="alert alert-success mt-3">
                        <strong>üìã Common Examples:</strong>
                        <ul class="mb-0 mt-2">
                            <li><strong>All Research Units:</strong> <code>C_rsh,C_rsh_ctr,C_rsh_inst,C_rsh_key,C_jrsh</code></li>
                            <li><strong>Academic Only:</strong> <code>C_acd,C_acd_dept,C_acd_prof</code></li>
                            <li><strong>Management & Admin:</strong> <code>C_mgt,C_mgt_offr,C_adm_sev</code></li>
                            <li><strong>Student Related:</strong> <code>C_su,C_col,C_hst</code></li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Help Modal -->
    <div class="modal fade" id="statusHelpModal" tabindex="-1" aria-labelledby="statusHelpModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="statusHelpModalLabel">Status Filter Reference Guide</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted">
                        Use these status codes in the "Status Filter" field. Enter multiple codes separated by commas 
                        (e.g., <code>1,4,5</code>) to include multiple statuses.
                    </p>
                    
                    <table class="table table-sm table-hover">
                        <thead>
                            <tr>
                                <th style="width: 15%;">Code</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>1</code></td>
                                <td>CU Admin Units/Academic Depts/Research Centres</td>
                            </tr>
                            <tr>
                                <td><code>2</code></td>
                                <td>Units Other than CU Departments/Units</td>
                            </tr>
                            <tr>
                                <td><code>3</code></td>
                                <td>CU-related Individual/Special Order</td>
                            </tr>
                            <tr>
                                <td><code>4</code></td>
                                <td>Council Members</td>
                            </tr>
                            <tr>
                                <td><code>5</code></td>
                                <td>Emeritus Professors</td>
                            </tr>
                            <tr>
                                <td><code>6</code></td>
                                <td>Honorary Graduates</td>
                            </tr>
                            <tr>
                                <td><code>7</code></td>
                                <td>College Trustees</td>
                            </tr>
                            <tr>
                                <td><code>8</code></td>
                                <td>Advisory Boards/Committees</td>
                            </tr>
                            <tr>
                                <td><code>9</code></td>
                                <td>College Donors</td>
                            </tr>
                            <tr>
                                <td><code>10</code></td>
                                <td>Newsletter as request / Subscription</td>
                            </tr>
                            <tr>
                                <td><code>11</code></td>
                                <td>Government</td>
                            </tr>
                            <tr>
                                <td><code>12</code></td>
                                <td>Local Culture</td>
                            </tr>
                            <tr>
                                <td><code>13</code></td>
                                <td>Local Individuals</td>
                            </tr>
                            <tr>
                                <td><code>15</code></td>
                                <td>Local Tertiary</td>
                            </tr>
                            <tr>
                                <td><code>17</code></td>
                                <td>Overseas Individuals</td>
                            </tr>
                            <tr>
                                <td><code>18</code></td>
                                <td>Special Request (local/overseas)</td>
                            </tr>
                            <tr>
                                <td><code>19</code></td>
                                <td>Secondary School (principle + student union)</td>
                            </tr>
                            <tr>
                                <td><code>20</code></td>
                                <td>Overseas Culture</td>
                            </tr>
                            <tr>
                                <td><code>21</code></td>
                                <td>Overseas Tertiary</td>
                            </tr>
                            <tr>
                                <td><code>22</code></td>
                                <td>LegCo Members (AR only)</td>
                            </tr>
                            <tr>
                                <td><code>23</code></td>
                                <td>ExeCo Members (AR only)</td>
                            </tr>
                            <tr>
                                <td><code>24</code></td>
                                <td>Education Commission Members (AR only)</td>
                            </tr>
                            <tr>
                                <td><code>26</code></td>
                                <td>Consulates (AR only)</td>
                            </tr>
                            <tr>
                                <td><code>27</code></td>
                                <td>Honorary Fellows</td>
                            </tr>
                            <tr>
                                <td><code>90</code></td>
                                <td>Alumni</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="alert alert-info mt-4">
                        <strong>üí° Tips:</strong>
                        <ul class="mb-0 mt-2">
                            <li>Use comma-separated values for multiple statuses: <code>1,4,5,27</code></li>
                            <li>Use "Status Exclude Filter" to exclude specific statuses</li>
                            <li>Combine with Category filters for precise targeting</li>
                        </ul>
                    </div>
                    
                    <div class="alert alert-success mt-3">
                        <strong>üìã Common Examples:</strong>
                        <ul class="mb-0 mt-2">
                            <li><strong>Internal CU Only:</strong> <code>1,3</code></li>
                            <li><strong>VIPs & Honor:</strong> <code>4,5,6,7,27</code></li>
                            <li><strong>External Partners:</strong> <code>2,11,12,15,20,21</code></li>
                            <li><strong>Government & Officials:</strong> <code>11,22,23,24,26</code></li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Publication Info Modal -->
    <div class="modal fade" id="publicationInfoModal" tabindex="-1" aria-labelledby="publicationInfoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-info text-white">
                    <h5 class="modal-title" id="publicationInfoModalLabel">
                        <i class="bi bi-file-earmark-text"></i> Publication Columns Reference
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h6 class="fw-bold text-primary mb-3">B. For Individual Publications</h6>
                    <p class="lead">
                        These columns indicate how many copies of specific publications should be sent to each recipient.
                        A positive integer (‚â•1) means the recipient is subscribed to that publication.
                    </p>
                    
                    <table class="table table-bordered table-hover">
                        <thead class="table-light">
                            <tr>
                                <th>Column Code</th>
                                <th>Publication Name</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code class="fs-6">BE</code></td>
                                <td><strong>Bulletin English</strong></td>
                                <td>English version of the university bulletin</td>
                            </tr>
                            <tr>
                                <td><code class="fs-6">BC</code></td>
                                <td><strong>Bulletin Chinese</strong></td>
                                <td>Chinese version of the university bulletin</td>
                            </tr>
                            <tr>
                                <td><code class="fs-6">BEC</code></td>
                                <td><strong>Bulletin English & Chinese</strong></td>
                                <td>Both English and Chinese versions</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="alert alert-info mt-4">
                        <strong>üí° How It Works:</strong>
                        <ul class="mb-0 mt-2">
                            <li><strong>Empty cell or 0:</strong> Not subscribed - recipient will be excluded</li>
                            <li><strong>1 or higher:</strong> Subscribed - recipient will be included</li>
                            <li><strong>Number indicates copies:</strong> The value shows how many copies to send</li>
                        </ul>
                    </div>
                    
                    <div class="alert alert-warning mt-3">
                        <strong>‚ö†Ô∏è Filter Behavior:</strong>
                        <ul class="mb-0 mt-2">
                            <li><strong>Select one or more:</strong> Recipients subscribed to <em>any</em> selected publication will be included</li>
                            <li><strong>Select none:</strong> No publication filtering (all recipients included regardless of subscriptions)</li>
                            <li><strong>Combine with other filters:</strong> Publication filters work together with Category, Status, and Zone filters</li>
                        </ul>
                    </div>
                    
                    <div class="alert alert-success mt-3">
                        <strong>üìã Example Use Cases:</strong>
                        <ul class="mb-0 mt-2">
                            <li><strong>English Bulletin only:</strong> Check <code>BE</code></li>
                            <li><strong>Chinese Bulletin only:</strong> Check <code>BC</code></li>
                            <li><strong>Any Bulletin:</strong> Check <code>BE</code>, <code>BC</code>, and <code>BEC</code></li>
                            <li><strong>Bilingual recipients:</strong> Check <code>BEC</code> only</li>
                        </ul>
                    </div>
                    
                    <h6 class="fw-bold text-primary mt-4 mb-3">Additional Publication Columns</h6>
                    <p>
                        Your Excel file may contain additional publication columns beyond BE, BC, and BEC. 
                        These follow the same pattern: a positive number (‚â•1) indicates subscription.
                        Common examples include:
                    </p>
                    <ul>
                        <li><strong>ARE:</strong> Annual Report English</li>
                        <li><strong>ARC:</strong> Annual Report Chinese</li>
                        <li><strong>Newsletter columns:</strong> Various departmental or faculty newsletters</li>
                        <li><strong>Magazine columns:</strong> University magazines or periodicals</li>
                    </ul>
                    <p class="text-muted small">
                        <em>Note: The system can be extended to support additional publication columns as needed.</em>
                    </p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center py-4 mt-5" style="color: var(--mauve);">
        <div class="container">
            <p class="mb-2"><strong>The Chinese University of Hong Kong</strong></p>
            <p class="small mb-0">Label Generator System | ¬© 2025 CUHK | All Rights Reserved</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/main.js"></script>
</body>
</html>